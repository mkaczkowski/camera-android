"use strict";var sioWebApp=angular.module("sioWebApp",["underscore","ngResource","ui.router","ionic","ng-cordova","hmTouchEvents","sioWebApp.config","sioWebApp.mock","sioWebApp.common","sioWebApp.navigation","sioWebApp.home","sioWebApp.friends"]);sioWebApp.config(["$stateProvider","$urlRouterProvider","loggerProvider",function(a,b,c){a.state("home",{url:"/home",templateUrl:"views/home/home.html",controller:"HomeCtrl"}).state("contact",{url:"/contact",templateUrl:"views/contact/contact.html",controller:"ContactCtrl",resolve:{loadMyModule:["$ocLazyLoad",function(a){return a.load(["sioWebApp.contact"])}]}}),b.otherwise("/home"),c.enabled(!0)}]),sioWebApp.run(["$rootScope","configuration","$timeout","logger","_",function(a,b,c,d,e){a.app=b;var f=d.getInstance("sioWebApp");f.log("This is a log"),f.info("This is a info"),f.warn("This is a warn"),f.debug("This is a debug for line {0}",[8]);var g=[10,5,100,3,1e3];f.debug(e.min(g))}]),angular.module("sioWebApp.config",[]).constant("configuration",{name:"SIO2 Backoffice",version:"SIO2 Backoffice v.1.0",copyright:"Ministerstwo Edukacji Narodowej, Szucha 25, Warszawa",restEndpoint:"",isProd:JSON.parse("true")}),angular.module("sioWebApp.home",[]),angular.module("sioWebApp.home").controller("HomeCtrl",["$scope","$ionicPopup","$ionicLoading","$timeout","imageService","cameraService","mySharedService",function(a,b,c,d,e,f,g){var h,i=function(){h=c.show({content:"Processing..."})},j=function(){h&&h.hide()};a.isSelected=!1,a.$watch(g.message,function(){console.info("watch:"+g.message),a.isSelected=g.message},!0),a.$on("handleBroadcast",function(){console.info("handleBroadcast:"+g.message),a.isSelected=g.message}),a.resetElement=function(){console.log("resetElement"),g.resetElement()},a.removeElement=function(){console.log("remove Element"),g.removeElement()},a.moveUp=function(){console.log("up"),g.moveUp()},a.moveDown=function(){console.log("down"),g.moveDown()},a.saveCanvasToFile=function(){i(),g.prepForBroadcast(null),d(function(){html2canvas([document.getElementById("draggableContainer")],{onrendered:function(a){e.saveCanvasToFile(a,function(){j()},function(){j()})}})},2e3)},a.getPicture=function(){f.takePicture("pictureImg")},a.clearWhiteboard=function(){var a=b.confirm({title:"Are you sure you want to clear?",okType:"button-energized"});a.then(function(a){a?g.clearAll():console.log("You are not sure")})},a.showAlert=function(){var a=b.alert({title:"Don't eat that!",template:"It might taste good"});a.then(function(){console.log("Thank you for not eating my delicious ice cream cone")})},g.init()}]),angular.module("sioWebApp.navigation",["sioWebApp.config"]),angular.module("sioWebApp.navigation").controller("NavigationCtrl",["$scope","$location",function(a,b){a.menuItems=[{name:"Home",path:"home"},{name:"Contact",path:"contact"}],a.isActive=function(a){return b.path().substr(0,a.length)==a}}]),angular.module("sioWebApp.common",[]),angular.module("sioWebApp.common").directive("debug",["$compile",function(a){return{terminal:!0,priority:1e6,link:function(b,c){var d=c.clone();c.attr("style","color:red"),d.removeAttr("debug");var e=a(d)(b);c.after(e)}}}]);var mySharedService=angular.module("sioWebApp.common").factory("mySharedService",["$rootScope",function(a){function b(a,b,d){var e;switch(a.type){case"touch":break;case"drag":d.posX=a.gesture.deltaX+d.lastPosX,d.posY=a.gesture.deltaY+d.lastPosY,e="translate("+d.posX+"px,"+d.posY+"px)",e+="rotate("+d.last_rotation+"deg) ",e+="scale("+d.last_scale+","+d.last_scale+")";break;case"transform":d.rotation=d.last_rotation+a.gesture.rotation,d.scale=Math.max(1,Math.min(d.last_scale*a.gesture.scale,10)),e="translate("+d.lastPosX+"px,"+d.lastPosY+"px) ",e+="rotate("+d.rotation+"deg) ",e+="scale("+d.scale+","+d.scale+")";break;case"transformend":d.last_scale=d.scale,d.last_rotation=d.rotation;break;case"dragend":d.lastPosX=d.posX,d.lastPosY=d.posY}c.applyTransform(b,e)}var c={},d={},e={posX:0,posY:0,lastPosX:0,lastPosY:0,bufferX:0,bufferY:0,scale:1,last_scale:1,rotation:0,last_rotation:0,dragReady:0},f={},g={};return c.init=function(){var a={transform_always_block:!0,transform_min_scale:1,drag_block_horizontal:!0,drag_block_vertical:!0,drag_min_distance:0};angular.element("#draggableContainer").hammer(a).on("touch drag dragend transform transformend",function(a){return angular.element(a.target).is("button")?!0:void(a.gesture&&(a.gesture.preventDefault(),"touch"==a.type&&(f=a.gesture.target.parentNode,g=c.getElement(f.className)),b(a,f,g)))})},c.applyTransform=function(a,b){console.info("trans:"+b),b&&(a.style.transform=b,a.style.oTransform=b,a.style.msTransform=b,a.style.mozTransform=b,a.style.webkitTransform=b)},c.addElement=function(a,b){function c(){for(var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c=0;5>c;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}a.first().css({top:b.top,left:b.left}),a.addClass(c()),d[a.get(0).className]=JSON.parse(JSON.stringify(e))},c.getElement=function(a){return d[a]},c.prepForBroadcast=function(a){this.message=a,this.broadcastItem()},c.broadcastItem=function(){a.$broadcast("handleBroadcast")},c.moveUp=function(){a.$broadcast("moveUp")},c.moveDown=function(){a.$broadcast("moveDown")},c.removeElement=function(){a.$broadcast("removeElement"),this.prepForBroadcast(null)},c.clearAll=function(){a.$broadcast("clearAll"),this.prepForBroadcast(null)},c.resetElement=function(){g=JSON.parse(JSON.stringify(e)),d[f.className]=g;var a="translate("+g.lastPosX+"px,"+g.lastPosY+"px) ";a+="rotate("+g.rotation+"deg) ",a+="scale("+g.scale+","+g.scale+")",c.applyTransform(f,a)},c.message,c}]);angular.module("sioWebApp.common").directive("draggableItem",["mySharedService",function(a){return{restrict:"E",templateUrl:"views/directives/draggable.html",replace:!0,piority:1e4,scope:{src:"@",top:"@",left:"@"},controller:["$scope","$element","mySharedService",function(a,b,c){a.isSelected=!0,c.prepForBroadcast(b)}],link:function(b,c){a.addElement(c,b),b.$on("handleBroadcast",function(){var e=a.message==c,f=e!=b.isSelected;b.isSelected=e,b.$apply(),f&&d()}),b.$on("removeElement",function(){b.isSelected&&c.remove()}),b.$on("moveUp",function(){if(b.isSelected){var a=parseInt(c.css("zIndex"));console.log(a),c.css("zIndex",a+1)}}),b.$on("moveDown",function(){if(b.isSelected){var a=parseInt(c.css("zIndex"));if(console.log(a),0==a)return;c.css("zIndex",a-1)}}),b.$on("clearAll",function(){b.removeElement()});var d=function(){var a=angular.element(c.children()[0]);b.isSelected?a.addClass("selectedDraggable").css("border","3px dashed #545565"):a.removeClass("selectedDraggable").css("border","")};d(),c.bind("click touchstart",function(){a.prepForBroadcast(c)}),c.on("$destroy",function(){})}}}]),angular.module("sioWebApp.common").directive("carousel",["$compile","mySharedService",function(a){return{restrict:"E",replace:!0,transclude:!0,template:'<div class="myCarousel" style="width: 100%;" ng-transclude></div>',link:function(b,c){function d(a){var b="";for(var d in a.items){var f=a.items[d].width,g=a.items[d].height,h=a.items[d].img,i=a.items[d].ext,j=h+i;b+="<div ><img class='thumb-img' style='max-width: 100%' data-width='"+f+"' data-height='"+g+"' src='"+j+"' ></div>"}c.html(b),e()}function e(){angular.element(".thumb-img").bind("click",function(c){var d=angular.element(c.target),e=parseInt(d.attr("data-width")),f=parseInt(d.attr("data-height")),g=d.attr("src"),h=angular.element(document.getElementById("draggableContainer")),i=(h.height()-f)/2,j=(h.width()-e)/2,k=a('<draggable-item id="1" src="'+g+'" top="'+i+'px" left="'+j+'px"/>')(b);h.append(k)})}c.owlCarousel({jsonPath:"data/data.json",jsonSuccess:d,singleItem:!1,lazyLoad:!0,navigation:!0,pagination:!1,items:4})}}}]),angular.module("sioWebApp.common").provider("logger",[function(){var a=!0;this.enabled=function(b){a=!!b},this.$get=["$log",function(b){var c=function(a){this.context=a};return c.getInstance=function(a){return new c(a)},c.supplant=function(a,b){return a.replace(/\{([^{}]*)\}/g,function(a,c){var d=b[c];return"string"==typeof d||"number"==typeof d?d:a})},c.getFormattedTimestamp=function(a){return c.supplant("{0}:{1}:{2}:{3}",[a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()])},c.prototype={_log:function(d,e){if(a){var f=c.getFormattedTimestamp(new Date),g="",h=[];switch(e.length){case 1:g=c.supplant("{0} - {1}: {2}",[f,this.context,e[0]]);break;case 3:h=e[2],g=c.supplant("{0} - {1}::{2}('{3}')",[f,this.context,e[0],e[1]]);break;case 2:"string"==typeof e[1]?g=c.supplant("{0} - {1}::{2}('{3}')",[f,this.context,e[0],e[1]]):(h=e[1],g=c.supplant("{0} - {1}: {2}",[f,this.context,e[0]]))}b[d].call(null,c.supplant(g,h))}},log:function(){this._log("log",arguments)},info:function(){this._log("info",arguments)},warn:function(){this._log("warn",arguments)},debug:function(){this._log("debug",arguments)},error:function(){this._log("error",arguments)}},c}]}]),angular.module("sioWebApp.common").controller("FileCtrl",["$scope","$cordovaFile",function(a,b){a.api=function(){b.checkDir(directory).then(function(){},function(){}),b.createDir(directory,!1).then(function(){},function(){}),b.checkFile(directory,file).then(function(){},function(){}),b.createFile(directory,file,!0).then(function(){},function(){}),b.removeFile(directory,file).then(function(){},function(){}),b.writeFile(directory,file).then(function(){},function(){}),b.readFile(directory,file).then(function(){},function(){}),b.downloadFile(source,filePath,!0,options).then(function(){},function(){}),b.uploadFile(server,filePath,options).then(function(){},function(){})}}]),angular.module("sioWebApp.common").factory("imageService",function(){var a={};return a.saveCanvasToFile=function(a,b,c){return window.canvas2ImagePlugin?void window.canvas2ImagePlugin.saveImageDataToLibrary(b,c,a):void c()},a.setWallpaper=function(a,b,c){var d="christmas",e="PluginImages";a="www/img/christmas.jpeg",wallpaper.setImage(a,d,e,b,c)},a}),angular.module("sioWebApp.common").controller("NetworkCtrl",["$scope","$cordovaNetwork",function(a,b){b.getNetwork(),b.isOnline(),b.isOffline()}]),angular.module("sioWebApp.common").controller("NotificationCtrl",["$scope","cordovaDialogs",function(){$cordovaDialogs.alert("Wow!")}]),angular.module("sioWebApp.common").factory("cameraService",["cordovaCamera",function(){var a={};return a.takePicture=function(a){var b={quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0,encodingType:Camera.EncodingType.JPEG,targetWidth:100,targetHeight:100,popoverOptions:CameraPopoverOptions,saveToPhotoAlbum:!1};navigator.camera.getPicture(function(b){var c=document.getElementById(a);c.src="data:image/jpeg;base64,"+b},function(a){console.error("error!!:"+a)},b)},a}]),angular.module("sioWebApp.common").controller("SharingCtrl",["$scope","$cordovaSocialSharing",function(a,b){}]),angular.module("sioWebApp.common").service("serviceUtil",["$resource","configuration",function(a,b){this.createResource=function(c,d){var e=a(b.restEndpoint+c,{},d);return this._applyHandlers(e,d)},this._applyHandlers=function(a,b){return angular.forEach(b,function(b,c){var d=c.substr(1);a[d]=function(b,d,e){return a[c](b,null,null).$promise.then(function(a){d(a)},function(a){toastr.error(a.statusText,"Błąd :: "+a.status),e&&e(a)})}}),a}}]),angular.module("sioWebApp.friends",[]),angular.module("sioWebApp.friends").controller("DashCtrl",["$scope",function(){}]),angular.module("sioWebApp.friends").controller("FriendsCtrl",["$scope","Friends",function(a,b){a.friends=b.all()}]),angular.module("sioWebApp.friends").controller("FriendDetailCtrl",["$scope","$stateParams","Friends",function(a,b,c){a.friend=c.get(b.friendId)}]),angular.module("sioWebApp.friends",[]).factory("Friends",function(){var a=[{id:0,name:"Scruff McGruff"},{id:1,name:"G.I. Joe"},{id:2,name:"Miss Frizzle"},{id:3,name:"Ash Ketchum"}];return{all:function(){return a},get:function(b){return a[b]}}}),angular.module("sioWebApp.mock",[]).run([function(){}]);